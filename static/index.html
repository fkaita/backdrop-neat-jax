<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scatter Plot</title>
  <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container">
  <div class="row">
    <div class="col-sm-6 text-center">
      <div class="container-fluid text-center" id="p5Container">
        <div id="scatterPlot" style="width: 100%; height: 500px;"></div>
      </div>

      <div class="panel-body text-center" id="customDataBox" style="display: none;">
        <a class="btn btn-warning btn-sm" id="customDataOrange">Orange Point</a>
        <a class="btn btn-primary btn-sm" id="customDataBlue">Blue Point</a>
        <a class="btn btn-success btn-sm" id="customDataSubmit">Submit Data</a>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function () {
  // Function to fetch dataset from the server
  function fetchDataset(type, trainSize, noise) {
    return $.ajax({
      url: '/generate_data',
      method: 'POST',
      contentType: 'application/json',
      data: JSON.stringify({ type, train_size: trainSize, noise }),
    });
  }

  // Function to plot the scatter plot
  function plotScatter(data) {
    const trainX = data.train_x;
    const trainLabels = data.train_label;

    // Separate data by class
    const class0 = trainX.filter((_, i) => trainLabels[i] === 0);
    const class1 = trainX.filter((_, i) => trainLabels[i] === 1);

    // Create traces
    const trace0 = {
      x: class0.map(point => point[0]),
      y: class0.map(point => point[1]),
      mode: 'markers',
      marker: { color: 'blue' },
      name: 'Class 0',
    };

    const trace1 = {
      x: class1.map(point => point[0]),
      y: class1.map(point => point[1]),
      mode: 'markers',
      marker: { color: 'orange' },
      name: 'Class 1',
    };

    const layout = {
      title: 'Scatter Plot with Classification Classes',
      xaxis: { title: 'X-axis' },
      yaxis: { title: 'Y-axis' },
    };

    // Render the plot
    Plotly.newPlot('scatterPlot', [trace0, trace1], layout);
  }

  // Fetch and display dataset when page loads
  fetchDataset('circle', 200, 0.5)
    .done(data => {
      plotScatter(data);
    })
    .fail(err => {
      console.error('Error fetching data:', err);
    });
});
</script>
</body>
</html>
